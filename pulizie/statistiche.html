<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8"/>
  <title>Turni Pulizie - Statistiche</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <link rel="icon" type="image/png" sizes="64x64" href="logo-64x64.png"/>
  <link rel="apple-touch-icon" sizes="192x192" href="logo-192x192.png"/>
  <link rel="manifest" href="manifest.json"/>
  <meta name="theme-color" content="#4b2e13"/>
  <link rel="stylesheet" href="style.css"/>
</head>
<body data-page="stats">
  
    </div>
  </div>

  <div class="app-shell">
    <header class="app-header">
      <img class="app-logo" src="logo.png" alt="Bottega del CaffÃ¨ - Turni pulizie"/>
      <div class="app-title">Bottega del CaffÃ¨</div>
      <div class="app-subtitle">Statistiche</div>
      
        <nav class="app-nav">
<button class="secondary" onclick="window.location.href='../index.html'" type="button">â¬…ï¸ App principali</button>
        <button type="button" onclick="window.location.href='index.html'">ğŸ  Home</button>
        <button type="button" onclick="window.location.href='scadenze.html'">ğŸ“… Scadenze</button>
        <button type="button" onclick="window.location.href='dafare.html'">ğŸ“„ Da Fare</button>
        <button type="button" onclick="window.location.href='completati.html'">âœ… Completati</button>
        <button type="button" onclick="window.location.href='statistiche.html'">ğŸ“ˆ Statistiche</button>
        <button type="button" onclick="window.location.href='impostazioni.html'">âš™ï¸ Impostazioni</button>
      </nav>
    </header>

    <main class="app-main">
      <section class="card">
        <h2>Riepilogo</h2>
        <div id="stats-summary"></div>
      </section>

      <section class="card">
        <h2>Completamenti per dipendente (ultimi 30 giorni)</h2>
        <div id="stats-by-employee"></div>
      </section>

      <section class="card">
        <h2>Ritardi medi</h2>
        <div id="stats-late"></div>
      </section>

      <section class="card">
        <h2>Export</h2>
        <div class="actions">
          <button type="button" id="export-csv-btn">Esporta CSV</button>
          <button type="button" id="export-json-btn" class="secondary">Esporta JSON</button>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      Web-app turni pulizie La Bottega del caffÃ©
    </footer>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="firebase-config.js"></script>
  <script src="script.js"></script>

<script>
    // Disabilita caching PWA: rimuove eventuali Service Worker e CacheStorage
    // cosÃ¬ l'app si aggiorna sempre senza dover cancellare cache/dati del browser.
    (async () => {
      if (!('serviceWorker' in navigator)) return;
      try {
        const regs = await navigator.serviceWorker.getRegistrations();
        await Promise.all(regs.map(r => r.unregister()));
      } catch (e) { /* ignore */ }

      try {
        if ('caches' in window) {
          const keys = await caches.keys();
          await Promise.all(keys.map(k => caches.delete(k)));
        }
      } catch (e) { /* ignore */ }
    })();
  </script>
</body>
</html>
